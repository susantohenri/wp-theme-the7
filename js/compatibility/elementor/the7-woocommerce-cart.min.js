!function(e){"use strict";e.the7CartWidget=function(t){let n,a,r,o,i=e(t);const s="the7-e-woo-cart-status-cart-empty",d="the7-e-woo-cart-fragment-content",c="the7-e-woo-cart-fragment-subtotal";i.vars={cartUpdateTimeout:800,supports_html5_storage:!0},e.data(t,"the7CartWidget",i),r={init:function(){n=new The7ElementorSettings(i);try{i.vars.supports_html5_storage="sessionStorage"in window&&null!==window.sessionStorage,window.sessionStorage.setItem("wd","test"),window.sessionStorage.removeItem("wd")}catch(e){i.vars.supports_html5_storage=!1}i.refresh()},bindEvents:function(){elementorFrontend.elements.$body.on("wc_fragments_loaded wc_fragments_refreshed",r.populateTemplate),i.on("change input",".the7-e-mini-cart-product .quantity .qty",r.updateCartItem)},unBindEvents:function(){elementorFrontend.elements.$body.off("wc_fragments_loaded wc_fragments_refreshed",r.populateTemplate),i.off("change input",".the7-e-mini-cart-product .quantity .qty",r.updateCartItem)},populateTemplate:function(t){let n=e(".the7-e-mini-cart-template"),a=n.find("."+d);if(a.length){if(!a.hasClass(s)){let e=n.find("."+d);if(e.length){i.find("."+d).replaceWith(e.clone())}let t=n.find("."+c);if(t.length){i.find("."+c).replaceWith(t.clone())}}}else a=i.find("."+d);i.removeClass(s),a.hasClass(s)?i.addClass(s):e(document.body).trigger("the7_wc_init_quantity_buttons"),i.find(".the7_templates > div").each((function(){let t=e(this).attr("class"),n=i.find("."+t).not(this);n.length&&n.replaceWith(e(this).clone())}))},updateCartItem:function(t){let n=!0;"undefined"==typeof wc_cart_fragments_params&&(n=!1),clearTimeout(o);let a=e(this);o=setTimeout((function(){let t=a.val(),r=a.parents(".the7-e-mini-cart-product"),o=r.find(".product-remove .remove").data("cart_item_key");r.addClass("the7-cart-loading"),e.ajax({url:dtLocal.ajaxurl,data:{action:"the7_update_cart_item",item_id:o,quantity:t,get_fragments:n},success:function(t){n?t&&t.fragments&&(e.each(t.fragments,(function(t,n){e(t).replaceWith(n)})),i.vars.supports_html5_storage&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(t.fragments)),localStorage.setItem(wc_cart_fragments_params.cart_hash_key,t.cart_hash),sessionStorage.setItem(wc_cart_fragments_params.cart_hash_key,t.cart_hash),t.cart_hash&&sessionStorage.setItem("wc_cart_created",(new Date).getTime())),e(document.body).trigger("wc_fragments_refreshed")):elementorFrontend.elements.$body.trigger("wc_fragment_refresh")},dataType:"json",method:"GET"})}),i.vars.cartUpdateTimeout)}},i.refresh=function(){a=n.getSettings(),r.unBindEvents(),r.bindEvents(),r.populateTemplate()},i.delete=function(){r.unBindEvents(),i.removeData("the7CartWidget")},r.init()},e.fn.the7CartWidget=function(){return this.each((function(){var t=e(this).data("the7CartWidget");void 0!==t&&t.delete(),new e.the7CartWidget(this)}))},e(window).on("elementor/frontend/init",(function(){elementorFrontend.hooks.addAction("frontend/element_ready/the7-woocommerce-cart-preview.default",(function(e,t){t(document).ready((function(){e.the7CartWidget(),e.hasClass("preserve-img-ratio-y")||window.the7ApplyWidgetImageRatio(e)}))})),elementorFrontend.isEditMode()&&elementorEditorAddOnChangeHandler("the7-woocommerce-cart-preview",(function(t,n){let a=[];const r=t.model.get("name");if("item_preserve_ratio"==r){e(n.$el).the7WidgetImageRatio("refresh")}else if(-1!==a.indexOf(r)){const t=e(n.$el),a=t.data("the7CartWidget");void 0!==a?a.refresh():t.the7CartWidget()}}))}))}(jQuery);