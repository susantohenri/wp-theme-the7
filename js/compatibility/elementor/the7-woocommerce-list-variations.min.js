jQuery((function(t){class e{constructor(t){this.data=t||{},this.data.outOfStockAttributes=this.findOutOfStockAttributes(),this.data.state=this.data.state||{},this.data.$originPrice=this.data.$price.clone()}getState(t){return t?this.data.state[t]:Object.assign({},this.data.state)}render(){const e=this.getState();if(!e)return;const a=this.data.$variations.find("li"),n=Object.keys(e).filter((function(t){return!!t})).map((function(t){return"a."+t+"_"+e[t]})).join(",");a.removeClass("active"),a.find(n).each((function(){t(this).parent().addClass("active")})),this.handleOutOfStockVisibility(this.findMatchingOutOfStockVariations());const i=this.findMatchingVariation();i?(this.data.$addToCartButton.attr("data-product_id",i.variation_id),this.data.$addToCartButton.removeClass("variation-btn-disabled"),i.price_html&&this.updateProductPriceData(t(i.price_html))):(this.data.$addToCartButton.attr("data-product_id",""),this.data.$addToCartButton.addClass("variation-btn-disabled"),this.updateProductPriceData(this.data.$originPrice.clone()))}updateState(t){this.data.state=Object.assign({},this.data.state,t),this.render()}findMatchingVariation(){const t=this.data.variations,e=this.getState();for(var a=[],n=0;n<t.length;n++){var i=t[n];this.isExactMatch(i.attributes,e)&&a.push(i)}return a.shift()}updateProductPriceData(t){this.data.$price.replaceWith(t),this.data.$price=t}handleOutOfStockVisibility(t){const e=t||this.data.outOfStockAttributes,a=this.data.$variations.find("li a");a.removeClass("out-of-stock");for(const[t,n]of Object.entries(e))if(n.length){const e=n.slice().map((function(e){return"."+t+"_"+e})).join(",");a.filter(e).addClass("out-of-stock")}}findMatchingOutOfStockVariations(){const t=this,e=this.data.variations,a=this.getState();let n=[];for(var i=0;i<e.length;i++){const t=e[i];!t.is_in_stock&&this.isMatch(t.attributes,a)&&n.push(t)}let o=Object.assign({},this.data.outOfStockAttributes);return n.forEach((function(e){for(const[a,n]of Object.entries(e.attributes))t.getState(a)!==n&&(o[a]=o[a].slice()||[],-1===o[a].indexOf(n)&&o[a].push(n))})),o}findOutOfStockAttributes(){const t=this.data.variations;let e=[],a=[],n={};for(let n=0;n<t.length;n++){let i=t[n];i.is_in_stock?e.push(Object.entries(i.attributes)):a.push(Object.entries(i.attributes))}e=[].concat(...e),a=[].concat(...a);const i=function(t,e){const a=e[0],n=e[1];return t[a]=t[a]||[],t[a].push(n),t},o=e.reduce(i,{}),s=a.reduce(i,{});for(const[t,e]of Object.entries(s))o[t]&&(n[t]=e.filter((function(e){return!o[t].includes(e)})));return n}isMatch(t,e){var a=!1;for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],o=e[n];void 0!==i&&void 0!==o&&0!==i.length&&0!==o.length&&i===o&&(a=!0)}return a}isExactMatch(t,e){var a=!0;for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],o=e[n];(void 0===i||void 0===o||0===o.length||0!==i.length&&i!==o)&&(a=!1)}return a}}t.productsVariations=function(a){const n=t(a),i=new The7ElementorSettings(n);let o={};t.data(a,"productsVariations",n),o={init:function(){const a=n.find(".quantity");if(a.length){const e=n.find(".box-button"),i=t(".qty",a);i.on("change",(function(){e.attr("data-quantity",parseInt(i.val()))}))}n.find("[data-product_variations]").each((function(){const a=t(this),n=a.find(".products-variations"),o=a.find(".box-button"),s=new e({variations:a.data("product_variations"),$addToCartButton:o,$variations:n,$price:a.find("span.price"),state:a.data("default_attributes")||{}});n.find("li a").data("the7_product_variations_obj",s),o.attr("data-product_id",""),o.on("click",(function(e){const a=t(this);if("n"==i.getCurrentDeviceSetting("show_variations"))return e.preventDefault(),void window.location.assign(a.attr("href"));a.is(".variation-btn-disabled")&&e.preventDefault()})),s.render()}));const s=n.find(".products-variations li a");if(t(".touchevents").length){let e,a;s.on("touchstart",(function(t){e=t.originalEvent.touches[0].pageY,a=t.originalEvent.touches[0].pageX})),s.on("touchend",(function(n){n.preventDefault();let i=n.originalEvent.changedTouches[0].pageX,s=n.originalEvent.changedTouches[0].pageY;if(e===s||a===i){const e=t(this);o.selectAttribute(e)}}))}else s.on("click",(function(e){e.preventDefault();const a=t(this);o.selectAttribute(a)}));if(!!t("html.mobile-true").length){const e=n.find(".trigger-img-hover");e.each((function(){const a=t(this);let s,r;if(a.hasClass("woo-ready"))return;const c=!!a.closest(".product-type-variable",n).length;a.on("touchstart",(function(t){s=t.originalEvent.touches[0].pageY,r=t.originalEvent.touches[0].pageX})),a.on("touchend",(function(a){const n=t(this),d=a.originalEvent.changedTouches[0].pageX,u=a.originalEvent.changedTouches[0].pageY,h=!n.hasClass("is-clicked");let l=h;if(h){let h;if(n.hasClass("woo-buttons-on-img"))h=!0;else{const t=n.find(".woo-buttons-on-img").get(0);h=a.originalEvent&&t&&a.originalEvent.composedPath().includes(t)}if(h&&t(a.target).closest(".products-variations-wrap, .woo-list-buttons",n).length){const t=i.getCurrentDeviceSetting("show_variations_on_hover"),e=i.getCurrentDeviceSetting("show_btn_on_hover");(!c||t&&"on-hover"!==t)&&(e&&"on-hover"!==e)&&(l=!1)}if(s==u||r==d){e.removeClass("is-clicked"),n.addClass("is-clicked");const t={boundaryElement:n.get(0),$affectedElements:e};elementorFrontend.elements.$body.off("touchstart",o.onOuterTouchHandler).on("touchstart",t,o.onOuterTouchHandler)}}l&&a.preventDefault()})),a.addClass("woo-ready")}))}},selectAttribute:function(t){if(t.is(".out-of-stock")||"n"===i.getCurrentDeviceSetting("show_add_to_cart"))return;const e=t.closest("ul").attr("data-atr");t.data("the7_product_variations_obj").updateState({[e]:t.parent().hasClass("active")?"":String(t.data("id"))})},onOuterTouchHandler:function(t){t.originalEvent&&t.data&&t.data.boundaryElement&&!t.originalEvent.composedPath().includes(t.data.boundaryElement)&&t.data.$affectedElements&&t.data.$affectedElements.removeClass("is-clicked")&&elementorFrontend.elements.$body.off("touchstart",o.onOuterTouchHandler)}},o.init()},t.fn.productsVariations=function(){return this.each((function(){void 0!==t(this).data("productsVariations")&&t(this).removeData("productsVariations"),new t.productsVariations(this)}))}})),jQuery(window).on("elementor/frontend/init",(function(){const t=function(t,e){e((function(){t.productsVariations()}))};elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products-carousel.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-woocommerce-loop-add-to-cart.default",t)}));